# 9.1 보안의 개념과 정의

- 외부에서 정보가 저장된 시스템을 사용하지 못하게 함
- 정보의 유출 시도에 맞서 적절히 보호, 운영하는 작업
- 3대 보안의 필수 요소
- 기밀성 : 인가되지 않은 사용자가 정보를 보지 못하게 하는 모든 작업. ex) 암호화 작업
- 무결성 : 누군가가 정보를 고의로 훼손하거나 중간에 특정 이유로 변경이 가해졌을 때, 그것을 파악해 잘못된 정보가 전달되거나 유지되지 못 하게 하는 것. ex) IMD5, SHA와 같은 해시(Hash) 함수를 이용해 변경 여부 파악.

- 가용성 : 정보가 필요할 때, 접근을 허락하는 작업.



## 9.1.2 네트워크의 정보 보안

-  네트워크 입장에서 의 정보 보안은 수집된 정보를 침해하는 행동을 기술적으로 방어하거나 정보의 송수신 과정에 생기는 사고를 막기 위한 작업. 
- 정보를 가진 시스템을 공격해 유출하거나 사용하지 못하게 하거나 시스템이 동작하지 못하게해 정보 서비스를 정상적으로 구동할 수 없 게 만드는 행위를 네트워크에서 적절히 막는 것이 네트워크 보안의 1차 목표
-  정보는 여러 가지 서비스를 제공하기 위해 한 자리에만 있는 것이 아니라 네트워크를 통해 복제, 이동되므로 그 유출을 막는 것이 2차 목표.



## 9.1.3 네트워크 보안의 주요 개념

- 트러트스 네트워크 : 보호받아야 할 네트워크
- 언트러스트 네트워크 : 신뢰할 수 없는 외부 네트워크

![image-20220109175658909](C:\Users\tkrhk\AppData\Roaming\Typora\typora-user-images\image-20220109175658909.png)

- DMZ 네트워크 : 외부 사용자에게 개방해야 하는 서비스 네트워크, 일반적으로 인터넷에 공개하는 서비스

![image-20220109175744584](C:\Users\tkrhk\AppData\Roaming\Typora\typora-user-images\image-20220109175744584.png)

- 네트워크 보안 분야는 트래픽의 방향과 용도에 따라 두 가지로 나눌 수 있음. 
- **인터넷 시큐어 게이트웨이(Internet Secure Gateway)** - 트러스트(또는 DMZ) 네트워크에서 언트러스트 네트워크로의 통신을 통제. ex) Secure Web Gateway, 웹필터, Application Control, 방화벽와 같은 장비로 보안을 유지

![image-20220109175939639](C:\Users\tkrhk\AppData\Roaming\Typora\typora-user-images\image-20220109175939639.png)

- **데이터 센터 시큐어 게이트웨이(Data Center Secure Gatewa y)** - 언트러스트 네트워크에서 트러스트(또는 DMZ)로의 통신을 통제. IPS, DataCenter Secure Gateway, Web Application Firewall 등의 장비가 사용.

![image-20220109180032622](C:\Users\tkrhk\AppData\Roaming\Typora\typora-user-images\image-20220109180032622.png)

### 9.1.3.1 네트워크 보안 정책 수립에 따른 분류

- 화이트리스트 : 방어에 문제가 없다고 명확히 판단되는 통신만 허용. 일반적으로 IP와 통신 정보에 대해 명확히 아는 경우에 사용됨.
- 블랙리스트 : 공격이라고 명확히 판단되거나 문제가 있었던 IP 리스트나 패킷 리스트를 기반으로 데이터베이스를 만들고 그 정보를 이용해 방어.

### 9.1.3.2 정탐, 오탐, 미탐(탐지 에러 타입)

![image-20220109180559180](C:\Users\tkrhk\AppData\Roaming\Typora\typora-user-images\image-20220109180559180.png)

# 9.2 보안 솔루션의 종류

- 보안 장비의 위치와 역할에 따라 다양한 네트워크 보안 장비가 있음.

![image-20220109182236857](C:\Users\tkrhk\AppData\Roaming\Typora\typora-user-images\image-20220109182236857.png)

- 데이터 센터에서 보안 장비를 디자인할 때 DDoS - 방화벽 - IPS - WAF 형태와 같이 여러 단계로 공격을 막도록 인라인 상에 여러 장비를 배치함. 
- 모든 공격을 장비 한 대로는 방어 할 수 없으므로 여러 장비의 기능으로 단계적으로 방어함.



## 9.2.1 DDoS 방어 장비

- Dos -> Denial of Service
- 다양한 방법으로 공격 목표에 서비스 부하를 가해 정상적인 서비스를 방해하는 공격 기법.

![image-20220109190946178](C:\Users\tkrhk\AppData\Roaming\Typora\typora-user-images\image-20220109190946178.png)

- C&C 서버 (Command & Control) : 서버들과 기술적인 인프라스트럭처들로 구성되어 일반적으로 악성코드 (주로 봇넷)을 제어하기 위해 사용

- DDOS : 공격자가 여러 대의 컴퓨터를 감염시켜 감염시킨 컴퓨터로 타깃을 동시에 공격하여 서비스를 지연 마비시키는 공격. (DOS 직접, DDOS 감염 공격)

- 볼류메트릭 공격 : 회선 사용량이나 그 이상의 트래픽을 과도하게 발생시켜 회선 사용을 방해하는 공격.
- 회선을 공급해주는 ISP나 연결되는 데이터 센터 네트워크의 가장 바깥쪽에 위치시켜 공격을 완화해야 함.

## 9.2.2 방화벽

- 4계층에서 동작하는 패킷 필터링 장비.
- 3, 4계층 정보를 기반으로 정책을 세워 해당 정책과 매치되는 패킷이 방화벽을 통과하면 그 패킷을 허용하거나 거부할 수 있음.



## 9.2.3 IDS, IPS

- IDS (Intrusion Detection System), IPS (Intrusion Prevention System)는 방화벽에서 방어할 수 없는 다양한 애플리케이션 공격을 방어하는 장비.

- 최근에는 애플리케이션 공격을 방어하는 장비를 IPS로 통칭
- IDS와 IPS는 사전에 공격 데이터베이스(Signature)를 제조사나 위협 인텔리전스(Threat Intelligence) 서비스 업체로부터 받음. 
- 이후 IDS와 IPS 장비에 인입된 패킷이 보유한 공격 데이터베이스에 해당하는 공격일 때, 차단하거나 모니터링한 후 관리자에게 알람을 보내 공격 시도를 알림. 
- 기존에는 공격인 것만 골라 방어하는 블랙리스트 기반의 방어 방식만 제공했지만 프로파일링 기반의 방어 기법이 IPS 장비에 적용되고 애플리케이션을 골라 방어할 수 있는 애플리케이션 컨트롤(Application Control) 기능이 추가되면서 화이트리스트 기반의 방어 기법도 IPS 장비에 적용할 수 있게 됨. 

## 9.2.4 WAF

- WAF(Web Application Firewall)는 웹 서버를 보호하는 전용 보안 장비.
- HTTP, HTTPS처럼 웹 서버에서 동작하는 웹 프로토콜의 공격을 방어함. 
- IDS/IPS 장비보다 범용성이 떨어지지만 웹 프로토콜에 대해 서는 더 세밀히 방어할 수 있음 
- WAF는 IPS에서 방어할 수 없는 IPS 회피 공격(Evasion Attack)을 방어 할 수 있음.

## 9.2.5 샌드박스

- 보안 장비의 발전으로 직접적인 공격을 원하는 서버에 접근하지 않고 악성 코드를 관리자 PC에 우회적으로 심고 이 악성 코드를 이용해 관리자 PC를 컨트롤하는 방식으로 공격 목표가 변함. 
- 악성 코드가 든 이메일을 관리자에게 직접 보내거나 관리자가 악성 코드를 내려받도록 다양한 방법으로 유도함. 
- 유명한 웹 사이트에 악성 코드가 포함된 낚시성 파일을 올려놓음. 영화 파일이나 유틸리티 프로그램을 실행하면 악성 코드가 동작하도록 파일을 변경한 후, 사용자가 직접 내려받도록 유도해 PC를 악성 코드에 감염시킴. 
- 이후 이 PC들을 외부에서 컨트롤하도록 C&C (Command & Control) 서버를 만들어놓고 감염 PC들이 이 C&C 서버로 연결하도록 조작함. 이때 기존 방화벽에서는 내부 사용자가 외부 서버로 통신을 정상적으로 시도한 것으로 보이므로 이 공격을 검출하거나 방어할 수 없음.
- 이 공격들이 발전해 현재 APT(Advance d Persistent Threat; 지능형 지속 공격)와 ATA(Advanced Target Attack; 지능형 표 적 공격)가 됨. 
- APT와 ATA의 공격을 막기 위해 IPS 장비와 C &C 서버와의 통신을 탐지할 수 있는 다양한 형태의 Anti-APT 솔루션 들이 개발됨. 
- 샌드박스는 APT의 공격을 방어하는 대표적인 장비로 악성 코드를 샌드박스 시스템 안에서 직접 실행시킴. 가상 운영체제 안에서 각종 파일을 직접 실행시키고 그 행동을 모니터링해 그 파일들의 악성 코드 여부를 판별하는 방법을 이용함. 이 방법은 기존 보안 장비와 보안 솔루션들을 피하는 회피 공격을 탐지하고 기존 보안 솔 루션들을 보완함. 

## 9.2.6 NAC

- Network Access Control : 네트워크에 접속하는 장치들을 제어.
- 네트워크에 접속할 때 인가된 사용자만 내부망에 접속할 수 있고 인가받기 전이나 승인에 실패한 사용자는 접 속할 수 없도록 제어하는 기술.

## 9.2.7 IP 제어

- 보안사고 추적이 쉽도록 고정 IP 사용 권고 지침이 금융권에 내려오면서 IP를 할당하고 추적하는 솔루션이 필요해졌고 할당된 IP를 관리 하고 나아가 정확히 의도된 IP 할당이 아니면 정상적으로 네트워크를 사용하지 못하게 하는 기능이 필요했음. 이 요구사항들을 구 현하기 시작한 것이 IP 제어 솔루션입니다.

## 9.2.8 접근 통제

- 서버나 데이터베이스에 대한 직접적인 접근을 막고 작업 추적 및 감사를 할 수 있는 접근 통제 솔루션.

![image-20220109192817267](C:\Users\tkrhk\AppData\Roaming\Typora\typora-user-images\image-20220109192817267.png)

- 서버 접근을 위한 모든 통신은 배스천 호스트를 통해서만 가능함. 
- 서버 호스트의 방화벽에 배스천 호스트에서 출발한 통신만 허용 하고 다른 통신은 모두 방어하도록 설정.
- 배스천 호스트의 보안, 감사를 높이면 보안을 강화할 수 있음. 

## 9.2.9 VPN

- 사용자 기반의 VPN 서비스를 제공해주는 장비를 VPN 장비라고 함. 
- 기존에는 별도의 VPN 서비스를 제공하는 하드웨어가 있었지만 현재는 대부분 방화벽이나 라우터 장비에 VPN 기능이 포함되어 있음.
- 회사 내부 네트워크에서만 접속 가능한 서버를 집에서 접속하기 위해서는 VPN을 이용하여 마치 회사 내부 네트워크에 있는것 처럼 만들어 주는 역할을 함.
- 가장 많이 사용하는 VPN은 IPSEC과 SSL. IPSEC은 주로 네트워크 연결용으로 쓰이고 SSLVPN은 사용자가 내부 네트워크에 연결 할 때 주로 쓰임.

# 9.3 방화벽

- 네트워크 중간에 위치해 해당 장비를 통과하는 트래픽을 사전에 주어진 정책 조건에 맞추어 허용하거나 차단하는 장비.

![image-20220109193608292](C:\Users\tkrhk\AppData\Roaming\Typora\typora-user-images\image-20220109193608292.png)

- 일반적으로 방화벽은 네트워크 3, 4계층에서 동작하며 세션을 인지하는 상태 기반 엔진(Stateful Packet Inspection)으로 동작함.

## 9.3.2 초기 방화벽 

- 초기 방화벽에서는 패킷의 인과 관계를 확인하지 못하고 장비에 등록된 정책만으로 단순히 패킷을 필터링했음. 
- 패킷의 세션 정보나 방향성과 상관없이 순수하게 방화벽에 설정된 정책에 따라 동작하므로 이런 초기 방화벽을 스테이트리스(Stateless) 또는 패킷 필터 (Packet Filter) 방화벽이라고 함.
- 패킷이 장비에 인입되면 해당 패킷이 방화벽에 설정된 정책에 일치 되는 것이 있는지 확인함. 이때 참고하는 조건을 5-튜플(5-Tuple) 이라고 함. 
- 5-튜플은 패킷의 3, 4계층 헤더 중 Source IP, Destination IP, Protocol No, Source Port, Destination Port 5가지 주요 필드를 뜻함. 
- 방화벽에 일치된 정책이 있으면 해당 정책에 따라 그 패킷을 허용하거나 차단합니다.

## 9.3.3 현대적 방화벽의 등장(SPI 엔진)

- 기존 패킷 필터 방화벽이 패킷의 상태값 없이 순수하게 정책만으로 제어하던 한계를 극복하기 위해 개발된 것이 상태 기반 방화벽(Statef ul Inspection Firewall). 
- 현재 우리가 ‘방화벽’이라고 부르는 모든 장비는 세션 기반으로 동작하는 상태 기반(SPI) 엔진을 탑재하고 있 음. 
- 패킷 필터는 가볍고 빠르지만 인터넷과 같이 불특정 다수와 통신할 때는 정책 관리가 매우 힘듦. 
- 통신은 대부분 양방향으로 이루어지는데 패킷 필터 엔진은 통신의 이런 양방향성을 인지하지 못 하고 단순히 패킷이 조건과 일치하는지만 검사함. (3 Way HandShaking에서 모든 iP및 포트를 열어야 하는 문제 )

![image-20220109194752519](C:\Users\tkrhk\AppData\Roaming\Typora\typora-user-images\image-20220109194752519.png)

## 9.3.4 방화벽 동작 방식

![image-20220109195059382](C:\Users\tkrhk\AppData\Roaming\Typora\typora-user-images\image-20220109195059382.png)