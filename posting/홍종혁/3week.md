# 3주차_네트워크 통신하기
📌   네트워크 통신 과정에서 필요한 주소인 MAC주소, IP 주소 / 주소 체계를 이루는 서브넷, 게잍웨이와 같은 용어와 ARP와 같은 프로토콜의 기능과 역할에 대해 알바봅시다.
# 3.1 유니캐스트, 멀티캐스트, 브로드캐스트, 애니캐스트
* 네트워크에서 출발지 → 목적지로 데이터를 전송시 사용하는 통신방식
    * 유니캐스트(Unicast)
        * 1:1 통신
        * 출발지와 목적지가 1:1로 통신
            * 실제로 사용하는 대부분의 통신은 유니캐스트 방식을 사용
    * 브로드캐스트(Broadcast)
        * 1:모든 통신
        * 출발지와 목적지가 1:1로 통신
            * 목적지 주소가 모든으로 표기된 통신 방식
            * 주로 유니캐스트로 통신하기 전, 상대방의 정확한 위치를 알기 위해 사용
            * 주소체계에 따라 브로드캐스트를 다양하게 분류할 수 있지만 기본 동작은 로컬 네트워크 내에서 모든 호스트에 패킷을 전달해야 할 때 사용
    * 멀티캐스트(Multicast)
        * 1:그룹(멀티캐스트 구독 호스트) 통신
        * 하나의 출발지에서 다수의 특정 목적지로 데이터 전송
            * 멀티캐스트 그룹 주소를 이용해 해당 그룹에 속한 다수의 호스트로 패킷을 전송하기 위한 통신 방식
            * IPTV와 같은 실시간 방송을 볼 때 이 멀티캐스트 통신 방식을 사용
            * 사내방송이나 즈권 시세 전송과 같이 단방향으로 다수에게 동시에 같은 내용을 전달해야 할 때 사용
    * 애니캐스트(Anycast)
        * 1:1 통신(목적지는 동일 그룹 내의 1개 호스트)
        * 다수의 동일 그룹 중 가장 가까운 호스트에서 응답
        * IPv4에서는 일부 기능 구현, IPv6은 모두 구현 가능
            * 최종 통신은 1:1로 유니캐스트와 애니캐스트가 동일하지만 통신할 수 있는 후보자가 다름
            * 유니캐스트는 출발지와 목적지가 모두 한 대씩이지만 애니캐스트는 같은 목적지 주소를 가진 서버가 여러 대여서 통신 가능한 다수의 후보군이 있다.
* 현재 주로 사용되는 네트워크 주소체계는 IPv4 기반
    * 일부 모바일 네트워크와 대규모 데이터 센터 위주로 새로운 IPv6기반 주소체계 사용
        * IPv6에서는 브로드캐스트대신 링크 로컬 멀티캐스트로 대체됨
* 여기서 중요한 점은 데이터를 전달하려는 출발지가 기준이 아닌 목적지 주소가 기준으로 구분된다는것
* BUM 트래픽
    * 트패픽 종류에 대한 내용을 다루다보면 BUM 트래픽이라는 용어를 사용하는것을 본적이 있다.
    * B, U, M
        * B(Broadcast)
        * U(Unknown Unicast)
            * 언노운 유니캐스트(U, Unknown Unicast)는 용어 그대로 유니캐스트여서 목적지가 명확히 명시되어있음
            * 하지만 스위치가 목적지에 대한 주소를 학습하지 못한 상황 (스위치 입장에서는 Unknown)이어서 패킷을 모든 포트로 전송하는데 이런 유니캐스트를 Unknown Unicast라고 한다.
            * BUM 트래픽의 이해가 가장 중요한 이유는 유니캐스트이지만 실제로 겉으로 보이는 동작 방식은 브로드캐스트에 가깝다.
            * 유니캐스트이므로 전달받은 모든 단말 NIC에서 도착지 주소를 비교하여 패킷을 받지만 네트워크 입장에서는 자원을 너무 많이 사용하므로 네트워크상에서 불필요한 B, U, M트래픽이 많아지면 네트워크 성능이 저하될 수 있다.
            * 이더넷 환경에서는 ARP브로드캐스트를 먼저 보내고 이휴 통신을 시작하므로 BUM트래픽이 많이 발생하지 않는데 ARP에 대한 내용은 3.5에서 다룬다.
        * M(Multicast)
        * B, U, M은 서로 다른 종류의 트래픽
        * but, 네트워크에서의 동작은 서로 비슷 
# 3.2 MAC주소
* MAC(Media Access Control)은 2계층(데이터링크)에서 통신을 위해 네트워크 인터페이스(랜카드)에 할당된 고유 식별자이다.
* MAC주소는 이더넷과 와이파이를 포함 대부분 IEEE 802네트워크 기술에서 2계층 주소로 사용
* 네트워크에 접속하는 모든 장비는 MAC 주소라는 물리적인 주소가 있어야 하므로 이 주소를 이용해 서로 통신하게 된다.
## 3.2.1 MAC 주소 체계
* MAC 주소는 변결할 수 없도록 하드웨어에 고정
* 모든 네트워크 장비 제조업체에서 장비가 출하될 때마다 MAC주소를 할당하는데 매번 이 주소의 할당 여부를 확인할 수 없으므로 한 제조업체에서 하나 이상의 주소 풀을 주고 그 풀 안에서 각 제조업체가 자체적으로 MAC주소를 할당
* 이렇게 장비 제조업체에 주소 풀을 할당하는것 == 제조사코드(Vendor Code) → 이주소는 IEEE에서 관리
    * MAC주소는 48비트의 16진수 12자리로 표현
    * 48비트는 다시 앞의 24비트와 뒤의 24비트로 구분
        * 앞에서 언급한 제조사코드가 앞의 24비트인 'OUI'값
            * OUI == IEEE가 제조사에 할당하는 부분
        * 뒤의 24비트의 값이 'UAA' == 각 제조사에서 할당하는 값
            * 각 제조사에서 네트워크 구성 요소에 할당하는 부분
* 유일하지 않은 MAC주소
    * MAC주소는 실수 또는 의도적으로 겹칠수 있다.
        * 하지만 동일 네트워크에 중복되지만 않으면 문제가 없다.
        * 네트워크 통신시 네트워크가 달라서 라우터의 도움을 받아야 할 경우, 라우터에서 다른 네트워크로 넘겨줄 때 출발지와 도착지의 MAC주소가 변경되기 때문이다.
## 3.2.2 MAC 주소 동작
* NIC는 자신의 MAC주소를 가지고 있고 전기 신호가 들어오면 2계층에서 패킷으로 변환하여 내용을 구분한 후 도착지 MAC주소를 확인
* 도착지 MAC주소와 자신의 MAC주소를 비교후 다르면 폐기
* MAC주소가 같거나 브로드캐스트, 멀티캐스트와 같은 그룹 주소라면 처리해야 할 주소로 인지해 상위계층으로 넘겨줌
* NIC에서 MAC주소의 비교를 통해 패킷을 폐기하는 경우와 달리 본인의 주소, 브로드캐스트 주소는 NIC 자체가 아닌 OS, 애플리케이션에서 처리해야 하므로 시스템에 부하가 작용
* 무차별 모드 (Promiscuous Mode)
    * 기본 NIC동작 방식은 패킷과 자신의 MAC주소를 비교하여 폐기한다.
    * 네트워크 상태를 모니터링하거나 디버그, 분석 용도로 네트워크 전체 패킷을 수집해 분석해야 할 경우
        * NIC이 정상적으로 동작하면 다른 목적지를 가진 패킷을 분석할 수 없다.
    * 다른 목적지를 가진 패킷을 분석하거나 수집해야 할 경우
        * 무차별 모드로 NIC를 구성
            * 무차별 모드는 자신의 MAC 주소와 상관없는 패킷이 들어와도 이를 분석할 수 있도록 메모리에 올려 처리할 수 있게 한다.
            * 대표적인 예시
                * 네트워크 패킷 분석 애플리케이션인 와이어샤크(Wireshark)
* 참고
    * MAC주소는 NIC에 종속되어있기 때문에 하나의 단말이 다수의 MAC주소를 가질 수 있다.
    * MAC주소에는 OUI(제조업체 코드)와 UAA(제조업체 할당주소)가 있기 때문에 MAC주소를 알면 장비 생산 업체를 확인할 수 있다.
# 3.3 IP주소
* OSI 7계층에서 주소를 갖는 계층은 2,3계층이다.
    * 2계층 : 물리주소인 MAC주소를 사용
    * 3계층 : 논리주소인 IP주소를 사용
* 대부분의 네트워크가TCP/IP로 동작하므로 IP 주소 체계를 이해하는 것이 네트워크를 이해하는데 매우 중요하다.
* IP주소를 포함한 다른 프로토콜 스택의 3계층주소는 다음과 같은 특징이 있다.
    1. 사용자가 변경 가능한 논리 주소이다.
    2. 주소에 레벨이 있다. 
        * 그룹을 의미하는 네트워크 주소와
        * 호스트 주소로 나뉨
## 3.3.1 IP주소 체계
* 우리가 흔히사용하는 IP주소는 32비트인 IPv4 주소이다.
    * IP는 v4, v6 두 체계가 존재, 각각 (32비트, 128비트)
        * IPv4
            * 4개의 옥텟(Octet)이라고 부르는 8비트 단위로 나누고 각 옥텟은 "."으로 구분
            * 2계층의 MAC주소가 16진수로 표기된 것과 달리 IP주소는 10진수로 표기하므로 8비트 옥텟은 0~255의 값을 쓸 수 있다.
            * 2계층 주소인 MAC주소가 제조업체 코드인 OUI와 제조업체별 일련 번호인 UAA의 두 부분으로 나뉘는 것과 목적이 다르지만 3계층 주소인 IP 주소도 네워크 주소와 호스트 주소 두 부분으로 나뉨
                * 네트워크 주소
                    * 호스트들은 모은 네트워크를 지칭하는 주소
                    * 네트워크 주소가 동일한 네트워크를 로컬 네트워크라고 함.
                * 호스트 주소
                    * 하나의 네트워크 내에 존재하는 호스트를 구분하기 위한 주소
            * (가장 큰 특징)MAC주소는 24비트씩 절반으로 나뉘지만 IP주소의 네트워크주소와 호스트주소는 경계점이 고정되있지 않다.
            * IP 주소 체계는 필요한 호스트의 IP개수에 따라 네트워크의 크기를 다르게 할당할 수 있는 Class 개념을 도입
                * A클래스(가장 큰 주소) : 약 1600만개
                * B클래스 : 약 6만5천개
                * C클래스 : 약 250개의 IP주소를 가질 수 있음
                    > 그 이유는 0.0.0.0의 형식에서 A클래스는 ㅁ.0.0.0 과 같이 첫 번째 옥텟에 네트워크와 호스트 주소를 나누는 구분자가 있고 B, C는 두번째, 세번째 옥텟에 구분자가 있기 때문에 (이 구분자를 서브넷 마스크라고 한다.)
                * 네트워크 주소와 호스트 주소를 나누는 구분자가 유동적이기 때문에 네트워크의 크기역시 유동적으로 변경할 수 있게 되었다.
                * 고정된 네트워크에 비해 주소의 절약, 








# 3.4 TCP와 UDP

# 3.5 ARP

 3.6 서브넷과 게이트웨이








































