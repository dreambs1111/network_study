# 5장 라우터 / L3스위치 : 3계층 장비
---
> ## [5.1] 라우터의 동작 방식과 역할
> ## [5.2] 경로지정 - 라우팅/스위치
> ## [5.3] 라우팅 설정 방법
---


> ## [5.1] 라우터의 동작 방식과 역할

- 라우터 : 3계층에서 동작하는 대표적인 네트워크 장비

    - 간단하게 이름 그대로 경로를 지정해주는 장치
    - 라우터는 원격지 네트워크와 연결시 필수 네트워크 장비


> __3계층에도 스위치가 있어요 ~__

```
- 3계층에도 3계층에서 동작하는 L3 스위치가 있다. 
- 소프트웨어 / 하드웨어
- 다양한 기능 / 패킷 전송 속도 최적화
- 각각 라우터 / 스위치 
- 로 나누었지만 기술의 발달로 최근에는 둘의 차이를 구분하기 어렵다
앞으로의 내용은 L3, 라우터 모두 해당되는 내용이다

```

- 라우터의 3가지 동작 방식
    - __[경로지정]__ : 패킷이 들어오면 IP주소와 라우팅 테이블을 비교해 최선의 경로로 패킷을 전송
    - __[브로드캐스트 컨트롤]__ : 패킷의 목적지 주소가 라우팅 테이블에 없으면 패킷을 버림
    - __[프로토콜 변환]__ : 패킷 포워딩 과정에서 기존 2계층 헤더 정보를 제거한 후 새로운 2계층 헤더를 만들어냄

> ### [5.1.1] 경로 지정

- 경로 지정은 라우터의 가장 중요한 역할
    1. 경로 정보를 모아 라우팅 테이블을 만든다
    2. 패킷이 들어오면 도착지 IP주소를 확인해 경로를 지정한다
    3. 패킷을 포워딩한다
- IP주소는 네트워크와 호스트로 나뉜 계층구조로(3.3.1참고) 이루어져 있다
    - 이로인해 IP주소를 확인해 로컬/원격지 네트워크를 구분할 수 있고 네트워크 주소를 기반으로 경로를 찾아갈 수 있다
    - 라우터는 이 IP주소를 확인해 원격지에 있는 적절한 경로로 패킷을 포워딩

> ### [5.1.2] 브로드캐스트 컨트롤(Broadcast Control)

- 스위치는 패킷의 도착지 주소를 모르면 어딘가에 존재할지 몰르기 때문에 위해 패킷을 모든 포트로 플러딩
    - 때문에 쓸모없는 패킷이 전송되서 전체 네트워크에 무리가 갈 수 있다고 생각하겠지만 LAN은 크기가 작아 플러딩에 대한 영향이 작고 패킷을 확인후 폐기하기 때문에 큰 무리를 주지 않는다

- 반면 라우터는 패킷을 원격지로 보내는 것이 목표이며 3계층에서 동작하고 분명한 도착지 정보가 있을시에만 통신을 허가한다
    - 만약 스위치와 같이 플러딩한다면 인터넷의 대역폭이 쓸모없는 패킷으로 가득차 통신 불능이 될 수 있다

- 따라서 라우터는 로컬 네트워크를 제외하고 경로 습득 설정을 하지 않으면 패킷을 포워딩할 수 없다
- 라우터의 기본 동작은 멀티캐스트 정보를 습득하지 않고 브로드캐스트 패킷을 전달하지 않는것
    - 이를 이용해 브로드캐스트가 다른 네트워크로 전파되는 것을 막을 수 있다
    - 이를 브로드캐스트 컨트롤 / 멀티캐스트 컨트롤 이라 한다
    - 네트워크에 브로드 캐스트가 많을경우 라우터로 네트워크를 분리하여 성능을 높일 수 있다!

> ### [5.1.3] 프로토콜 변환

- 라우터의 3번째 역할은 서로 다른 프로토콜로 구성된 네트워크를 연결하는 것
- 현대 네트워크는 이더넷으로 수렴하므로 이 역할이 많이 줄었지만 과거에는 LAN에서 사용하는 프로토콜과 WAN에서 사용하는 프로토콜이 전혀 다른, 완전히 구분된 공간이었다
    - LAN : 다수 컴퓨터가 함께 통신하는데 초점
    - WAN : 원거리 통신이 목적
- 이 당시에는 LAN기술이 WAN기술로 변환되야만 인터넷과 같은 원격지 네트워크 통신이 가능했고 이를 라우터가 담당했다

- 라우터는 패킷이 오면 2계층 헤더를 벗겨내고 3계층 주소 확인후 2계층 헤더를 새로 입힌다
- 이를 이용해 프로토콜이 다른 장치들 간에 통신이 가능하게 된다

> ## [5.2] 경로지정 - 라우팅/스위칭

- 라우터가 패킷 처리시 크게 두 가지 작업을 수행
    - 경로 정보를 얻어 경로 정보를 정리하는 역할
    - 정리된 경로 정보를 기반으로 패킷을 포워딩하는 역할
- 좀 더 쉽게 말하면 최적 경로 확보와 패킷 포워딩
- 라우터는 라우터 테이블에 없는 목적지를 가진 패킷이 들어오면 버리기 때문에 경로 정보를 충분히 가지고 있어야 라우터가 정상 작동한다

- 라우터는 
