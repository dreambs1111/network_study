# 유니캐스트, 멀티캐스트, 브로드캐스트, 애니캐스트

- 유니캐스트
    - 출발지와 목적지가 1:1로 통신
    - 1:1 통신
- 브로드캐스트
    - 1:모든 통신
    - 동일 네트워크에 존재하는 모든 호스트가 목적지
- 멀티캐스트
    - 1:그룹(멀티캐스트 구독 호스트) 통신
    - 하나의 출발지에서 다수의 특정 목적지로 데이터 전송
- 애니캐스트
    - 1:1 통신(목적지는 동일 그룹 내의 1개 호스트)
    - 다수의 동일 그룹 중 가장 가까운 호스트에서 응답
    - IPv4에서는 일부 기능 구현, IPv6은 모두 구현 가능

## 유니캐스트

: **출발지와 목적지가 명확히 하나로 정해져 있는 1:1 통신 방식**입니다. 실제로 사용하는 대부분의 통신은 유니캐스트 방식을 사용합니다.

## 브로드캐스트

: **목적지 주소가 모든으로 표기되어 있는 통신 방식**

- 유니캐스트로 통신하기 전, 주로 상대방의 정확한 위치를 알기 위해 사용
- 주소 체계에 따라 브로드캐스트를 다양하게 분류할 수 있지만 기본 동작은 로컬 네트워크 내에서 모든 호스트에 패킷을 전달해야 할 때 사용
## 멀티캐스트

: 멀티캐스트 그룹 주소를 이용해 해당 그룹에 속한 다수의 호스트로 패킷을 전송하기 위한 통신 방식

- 사내 방송이나 증권 시세 전송과 같이 단방향으로 다수에게 동시에 같은 내용을 전달해야 할 때 사용
    
## 애니캐스트

: 애니캐스트 주소가 같은 호스트들 중에서 가장 가깝거나 가장 효율적으로 서비스할 수 있는 호스트와 통신하는 방식

- 가장 가까운 DNS 서버를 찾을 때 사용하거나 가장 가까운 게이트웨이를 찾는 애니캐스트 게이트웨이 기능에 사용

    ⇒ 유니캐스트는 출발지와 목적지가 모두 한 대씩이지만 애니캐스트는 같은 목적지 주소를 가진 서버가
    여러 대여서 통신 가능한 다수의 후보군이 있음
    

> 현재 주로 사용되는 네트워크 주소 체계는 IPv4 기반이다. 일부 모바일 네트워크와 대규모 데이터 센터 위주로 새로운 IPv6 기반 주소 체계가 사용되고 있습니다. IPv6에서는 브로드캐스트가 존재하지 않고 링크 로컬 멀티캐스트로 대체되어 사용
> 

---

# MAC 주소

: MAC 주소는 Media Access Control의 줄임말로 2계층(데이터 링크 계층)에서 통신을 위해 네트워크 인터페이스에 할당된 고유 식별자

→ MAC 주소는 이더넷과 와이파이를 포함한 네트워크 기술에서 2계층 주소로 사용됨

→ 네트워크에 접속하는 모든 장비는 MAC 주소라는 물리적인 주소가 있어야 하고 이 주소를 이용해 서로 통신하게 됨

## MAC 주소 체계

- 변경할 수 없도록 하드웨어에 고정되어 출하되어, 네트워크 구성 요소마다 다른 주소를 가지고 있음
- 각 네트워크 장비 제조업체에 하나 이상의 주소 풀을 주고 그 풀 안에서 제조업체가 자체적으로 MAC 주소를 할당함 (제조업체에 주소 풀을 할당하는 것을 제조사 코드라고 하며, 이 주소는 국제기구 IEEE가 관리함)
- MAC 주소는 48비트 16진수 12자리로 표현됨
- 제조사 코드가 **OUI 값**, 제조사 자체적으로 할당해 네트워크에서 각 장비를 구분할 수 있게 하는 **UAA값**

## MAC 주소 동작

- NIC(Network Interface Card)는 MAC주소를 가지고 있다.
- NIC는 전기 신호가 들어오면 2계층에서 데이터 형태(패킷)로 변환하여 내용을 구분한 뒤 도착지 MAC주소를 확인한다.
- 만약 도착지 MAC주소가 자신이 갖고있는 MAC주소와 다를경우 패킷을 폐기한다.
- MAC주소가 같거나 브로드캐스트, 멀티캐스트와 같은 그룹주소일 경우 처리해야 할 주소로 인지해 패킷 정보를 상위 계층으로 넘겨준다.
- 본인의 주소, 브로드캐스트 주소는 NIC가 자체적으로 패킷을 처리하는게 아니라 OS나 애플리케이션에서 처리해야 하기 때문에 시스템 부하가 작용함
- 브로드캐스트 스톰의 경우 브로드캐스트가 회선을 모두 채우게 되는데 네트워크에 연결된 모든 단말이 브로드 캐스트를 처리하느라 CPU사용량이 증가함

---

# IP 주소

: 3계층에서 사용하는 논리 주소인 IP 주소. 대부분의 네트워크가 TCP/IP로 동작하므로 IP 주소 체계를 이해하는 것이 중요. 다음과 같은 3계층 주소의 특징이 있다.

1. 사용자가 변경 가능한 논리 주소임
2. 주소에 레벨이 있음. 그룹을 의미하는 네트워크 주소와 호스트 주소로 나눔

## IP 주소 체계

- 우리가 흔히 사용하는 IP 주소는 32비트인 IPv4 주소
- IP는 v4, v6 두 체계가 사용되며 IPv6 주소는 128비트
- IPv4 주소를 표기할 때 4개의 옥텟(8비트 단위)으로 나누고 각 옥텟을 "."으로 구분함
- IP 주소는 10진수로 표기하므로 8비트 옥텟은 0~255의 값을 쓸 수 있음
- IP 주소는 네트워크 주소와 호스트 주소 두 부분으로 나뉨
    - 네트워크 주소: 호스트들을 모은 네트워크를 지칭하는 주소. 네트워크 주소가 동일한 네트워크를 로컬 네트워크라고 함.
    - 호스트 주소: 하나의 네트워크 내에 존재하는 호스트들을 구분하기 위한 주소
    
    ⇒ IP 주소의 네트워크 주소와 호스트 주소를 구분하는 **경계점이 고정되어 있지않음**
    
- IP 주소 체계는 필요한 호스트 IP 개수에 따라 네트워크의 크기를 다르게 할당할 수 있는 클래스 개념을 도입함
- IP 주소가 도입한 클래스 개념은 다른 고정된 네트워크 주소 체계에 비해 주소를 절약할 수 있다는 장점이 있음

⇒ 네트워크 크기가 모두 같다고 생각해보자. 큰 네트워크를 필요한 경우는 네트워크를 여러 개 확보해야하는 어려움이 있고 연속적으로 존재하는 네트워크를 할당받기 어려움. 작은 네트워크를 쓰는 경우는 공간을 다 활용하지 못함에도 네트워크 주소 하나를 가져가기 때문에 네트워크 주소와 공간이 낭비된다

## 클래스 구분법

A, B, C 클래스는 맨 앞 옥텟의 주소만 보고 구분할 수 있음

- A 클래스
    - 앞 옥텟의 주소가 0~127 인 경우
    - 127은 예외로 자신을 의미하는 루프백 주소로 사용되어, 실제로 A 클래스로 사용할 수 있는 주소는 1.0.0.0~126.255.255.255까지 임
- B 클래스
    - 첫 옥텟을 2진수로 표기했을 때 첫번째 자리가 1이고 두번째 자리가 0인 경우
    - 128~191의 주소를 가짐
- C 클래스
    - 첫 옥텟을 2진수로 표기했을 때 첫번째와 두번째 자리가 1이고 세번째 자리가 0인 경우
    - 192~223의 주소를 가짐
    

⇒ **클래스 기반의 네트워크 분할 기법은 과거에 사용**했던 개념으로, 현재는 클래스 기반 네트워크를 사용하지 않음. 보다 네트워크 주소를 세밀하게 분할하고 할당하기 위해 **필요한 네트워크의 크기에 맞춰 1비트 단위로 네트워크를 분할함.**

## 클래스풀과 클래스리스

앞서 설명한 클래스 기반의 IP 주소 체계를 클래스 풀이라 함. 클래스 풀 체계에서는 서브넷 마스크(네트워크 주소와 호스트 주소를 구분짓는 구분자)가 필요 없고, 주소의 맨 앞자리 숫자만 보면 주소가 어느 클래스에 속해 있는지 구분할 수 있었음.

IP 주소 부족과 낭비 문제를 해결하기 위해 3가지 보존, 전환 전략을 만들어냈다. **클래스리스(CIDR 기반의 주소체계) , NAT와 사설 IP 주소, 차세대 IP IPv6임**

IPv4의 큰 문제는 주소 자체의 부족과 상위클래스를 할당받은 조직에서 주소들을 제대로 사용하지 못하면서 낭비하는 것이었음. 이러한 문제를 해결하기 위한 **클래스 개념을 버린, 클래스리스 기반 주소 체계를 현재 우리가 사용**하고 있음.

## 서브넷 마스크

: 클래스리스 네트워크에서는 별도로 네트워크와 호스트 주소를 나누는 구분자를 사용해야 하는데, 이 구분자를 서브넷 마스크라고 함. 

서브넷 마스크는 1은 네트워크 주소, 0은 호스트 주소로 표시함

→ 10진수로 서브넷 마스크를 표현하면 A 클래스는 255.0.0.0, B 클래스는 255.255.0.0, C 클래스는 255.255.255.0 이 됨.

ex) (&연산이용) 103.9.32.146 주소에 255.255.255.0 서브넷 마스크를 사용하는 IP는 네트워크 주소가 103.9.32.0이고 호스트 주소는 0.0.0.146이 됨. 서브넷 마스크가 2진수 1인 부분(10진수 255인 부분)은 IP 숫자가 그대로 연산 결과가 되고 서브넷 마스크가 0인 부분은 모두 0으로 변경됨.

## 서브네팅

서브네팅은 부여된 클래스 기준을 무시하고 새로운 네트워크-호스트 구분 기준을 사용자가 정해 원래 클래스풀 단위의 네트워크보다 더 쪼개 사용하는 것을 말한다. 부여된 주소를 다시 잘라서 사용하는 것을 서브네팅이라 하는 것이고, 현대 클래스리스 네트워크의 가장 큰 특징이다.

이 서브네팅이 어려운 이유는 옥텟 단위가 아닌 2진수의 1비트 단위로 네트워크를 분할하기 때문이다.

⇒ 서브넷 마스크를 중심으로 계산이 이루어짐

실무에서 서브네팅에 대해 고민하는 경우가 두가지인데, 

- **이미 분할된 네트워크에서 사용자**가 자신의 네트워크와 원격지 네트워크를 구분해야 하는 경우와
- **네트워크 설계자**가 네트워크를 어떻게 효율적으로 분할할 것인지 계획하는 경우이다.

### 네트워크 사용자 입장에서의 서브네팅

- 네트워크에서 사용할 수 있는 IP 범위 파악 (자신이 속한 네트워크의 유효 범위를 파악함)
- 기본 게이트웨이와 서브넷 마스크 설정이 제대로 되어있는지 확인

<간단한 서브네팅 방법>
IP 주소: 103.9.32.146
서브넷 : 255.255.255.192

1. 서브넷 마스크를 2진수로 변환한다. 
	=> 11111111.11111111.11111111.11000000

2. 현재 서브넷이 가질 수 있는 최대 IP 개수를 파악한다.
	=> 끝이 11000000 이기에 6비트를 가질 수 있고 2^6 = 64개를 가질 수 있다. 

3. 64의 배수로 나열해 기준이 되는 네트워크 주소를 파악한다. 
	=> 0 ~ 63, 64 ~ 127, 128 ~ 191, 192 ~ 255
	=> 각 네트워크의 마지막 주소는 브로드캐스트 주소가 된다. 

4. 103.9.32.146에서 호스트 주소 146이 속한 네트워크를 선택한다.
	=> 128 ~ 191

5. 필요한 주소를 정리한다.
	=> 네트워크 주소: 103.9.32.128 (첫 번째 숫자)
	=> 브로드캐스트 주소: 103.9.32.191 (마지막 숫자)
	=> 유효 IP범위 : 103.9.32.129 ~ 103.9.32.190 (네트워크 주소와 브로드캐스트 주소 사이)

### 네트워크 설계자 입장에서의 서브네팅

- 사용자 입장과 다르게 네트워크의 크기를 고민해 서브넷 마스크를 결정하고 설계에 반영
- IP 설계 시 서브넷된 하나의 네트워크에 IP를 몇개나 할당해야하는지, 서브넷된 네트워크가 몇개나 필요한지 와 같은 부분을 고려해야한다.

<회사 설계 예시>
	=> 12곳의 지사
	=> 지사는 최대 12대의 IP가 필요한 PC와 복합기, IP 카메라가 운영될 예정
	=> 현재 가진 네트워크는 103.9.32.0/24 네트워크

1. 서브넷된 하나의 네트워크에 12개 IP를 할당해야 한다.

2. 네트워크는 2진수의 배로 커지기에(4, 8, 16, 32, 64, 128, 256) 
	 2진수 단위로 네트워크 할당이 가능하다.
	=> 12개의 IP를 수용할 수 있는 최소한의 네트워크는 16개이다. 
	=> 네트워크 &브로드캐스트 주소(2개)를 제외해야하기에 실제 사용가능한 IP는 14개

3. 16개짜리 네트워크 12개를 확보한다. 
	네트워크주소 / 브로드캐스트 주소/ 유효 IP범위     / 할당
	103.9.32.0  / 103.9.32.15     / 103.9.32.1~14   / 네트워크 장비 주소
	103.9.32.16 / 103.9.32.31     / 103.9.32.17~30  / 시리얼 구간(라우터 중간 네트워크 할당용)
	103.9.32.32 / 103.9.32.47     / 103.9.32.33~46  / 1번 지사
	...
	...
	103.9.32.208/ 103.9.32.223    / 103.9.32.225~238/ 12번 지사
	...
	103.9.32.240/ 103.9.32.254    / 103.9.32.241~253/ 추후 할당

네트워크를 단계적으로 잘 설계하면 관리하기 쉽고 네트워크 장비 성능도 향상됨. 잘 설계된 네트워크는 라우터가 관리하는 경로가 적기에 관리하기 편한 반면, 잘못 설계된 네트워크는 실제로 존재하는 네트워크 수만큼 코어 라우터가 모든 경로를 알고 있어야 함. 

잘 설계된 네트워크는 네트워크 전체의 성능이 향상되고 관리가 편해질 수 있지만, IP 주소가 낭비됨. 그래서 이와 같은 네트워크를 디자인 하려면 IP를 여유 있게 사용할 수 있는 사설 IP 대역으로 네트워크를 설계해야 함.


## 공인 IP와 사설 IP

- 공인 IP: 인터넷에 접속하기 위해 필요한 IP 주소, 전세계에서 유일한 식별자
- 사설 IP: 인터넷에 연결하지 않고 개인적으로 네트워크를 구성할 때 사용하는 IP. 공인 IP를 할당받지 않고도 네트워크를 구축할 수 있음
    - 인터넷에 접속하지 않거나 NAT(네트워크 주소 변환) 기술을 사용할 경우 사설 IP 주소를 사용할 수 있음
    - 사설 IP를 사용하면 인터넷에 직접 접속하지 못하지만, NAT 장비에서 공인 IP 로 변경한 이후 인터넷 접속이 가능함
    - 가정에서 사용하는 공유기가 NAT 장비의 역할을 하는 대표적인 예
    

사설 네트워크 구축 시 NAT를 사용하여 인터넷에 연결하더라도 다른 사용자에게 할당된 IP를 사설 네트워크 주소로 사용하면 안됨. 내부 네트워크에 할당된 IP를 공식으로 사용하는 네트워크로 접속할 수 없기 때문에, 인터넷 어느 구간에서도 사용되지 않는 RFC에 명시된 사설 IP 대역을 사용하는 것이 좋다

**다른 기관에서 사용하는 공인 IP를 회사 내부에서 사용하면 접속이 불가능함**


- 그림의 C 회사처럼 회사 내부 사설 IP를 20.0.0.0/24 네트워크로 할당한 경우, 공인 IP로 변환하더라도 실제 A 회사의 20.0.0.0/24 네트워크로 통신이 불가능하다
- C 회사의 20.0.0.10 서버에서 A 회사의 20.0.0.20 서버(인터넷)로 접근을 시도할 경우, C 회사의 서버는 A
회사의 서버가 같은 네트워크에 존재하는 것으로 인식하고 A 회사 서버인 20.0.0.20과 통신하기 위해 브로드캐스트함. 실제로 **A회사와 C 회사는 인터넷 구간을 거쳐 통신해야 하므로 원격지와 통신 시도를 서로 인식해야만 정상적인 통신이 가능**하지만 현재 네트워크 구조에서는 같은 네트워크로 인식하므로 정상적인 통신이 불가능함.

> +) Bogon IP : IP 주소 할당 최상위 기구(IANA)가 여러 목적으로 예약해서 공인 IP로 할당하지 않는 주소
>