# TCP & UDP

: TCP/IP 프로토콜 스택의 4계층에서 동작하는 TCP와 UDP 프로토콜

→ 2계층과 3계층은 목적지를 정확히 찾아가기 위한 주소 제공이 목적이었다.

→ 4계층에서 동작하는 프로토콜은 목적지 단말 안에서 동작하는 여러 애플리케이션 프로세스 중 통신해야 할 목적지 프로세스를 정확히 찾아가고 패킷 순서가 바뀌지 않도록 잘 조합해 원래 데이터를 잘 만들어내기 위한 역할을 한다.

## 4계층 프로토콜(TCP, UDP)과 서비스 포트

인캡슐레이션, 디캡슐레이션 과정에 각 계층에서 정의하는 헤더가 추가되고 여러 가지 정보가 들어가는데, 그 정보 들 중 가장 중요한 두 가지 정보는

- 각 계층에서 정의하는 정보
- 상위 프로토콜 지시자 정보

송신 측에서 추가한 4계층의 정보(시퀀스 번호, ACK 번호 등)는 수신 측 4계층에서 확인하고 사용한다.

상위 프로토콜 지시자는 디캡슐레이션 과정에서 상위 계층의 프로토콜이나 프로세스를 정확히 찾아가기 위한 목적으로 사용되는데, 2계층은 이더 타입, 3계층은 프로토콜 번호, 4계층은 포트 번호가 상위 프로토콜 지시자이다.

TCP/IP 프로토콜 스택에서 4계층은 TCP와 UDP가 담당한다. 4계층의 목적은 목적지를 찾아가는 주소가 아니라 애플리케이션에서 사용하는 프로세스를 정확히 찾아가고 데이터를 분할한 패킷을 잘 쪼개 보내고 잘 조립하는 것인데,  패킷을 분할하고 조합하기 위해 TCP 프로토콜에서는 시퀀스 번호와 ACK 번호를 사용한다.

- TCP/IP 프로토콜 스택에서 4계층의 상위 프로토콜 지시자는 포트 번호
- 4계층 프로토콜 지시자인 포트 번호는 출발지와 목적지를 구분해 처리
- 서비스 요청 시와 응답 시에는 출발지 IP와 목적지 IP가 반대가 되듯이 출발지와 도착지 포트 번호도 요청 패킷과 응답 패킷이 반대
    

## TCP

: TCP는 4계층의 특징을 대부분 포함하는데,

TCP 프로토콜은 신뢰할 수 없는 공용망에서도 정보유실 없는 통신을 보장하기 위해 세션을 안전하게 연결하고 데이터를 분할하고 분할된 패킷이 잘 전송되었는지 확인하는 기능이 있다. → **신뢰할 수 있음**

- 패킷에 번호(Sequence Number)를 부여하고 잘 전송되었는지에 대해 응답(Acknowledge Number)한다.
- 수신자가 잘 받아 처리할 수 있는 전송 크기(Window Size)를 고려해 통신한다.

## UDP

: TCP와 달리 UDP는 4계층 프로토콜이 가져야 할 특징이 거의 없다. TCP에서 소개한 4계층의 여러 안전 장치 기능들이 UDP에는 없고, UDP 헤더도 TCP 헤더와 비교하면 내용이 거의 없다.
⇒ UDP는 데이터 전송을 보장하지 않는 프로토콜이므로 제한된 용도로만 사용함

### UDP의 용도

- 음성 데이터나 실시간 스트리밍과 같이 시간에 민감한 프로토콜이나 애플리케이션을 사용
- 사내 방송이나 증권 시세 데이터 전송에 사용되는 멀티캐스트처럼 단방향으로 다수의 단말과 통신해 응답을 받기 어려운 환경에서 주로 사용

⇒ 신뢰성보다는 일부 데이터가 유실되더라도 시간에 맞춰서 계속 전송하는것이 중요한 시스템에서 UDP를 사용하게 된다. **UDP에서는 일부 데이터가 유실되더라도 그대로 데이터를 처리한다.**

### UDP의 특징

- UDP는 TCP와 다르게 3방향 핸드셰이크처럼 사전에 연결을 확립하는 과정이 없다. 대신 UDP의 첫 데이터는 리소스 확보를 위해 인터럽트(Interrupt)를 거는 용도로 사용되고 유실된다 (UDP 프로토콜을 사용하는 앱 대부분은 이런 상황을 인지하고 동작함)
- 연결 확립은 TCP 프로토콜을 이용하고 앱끼리 모든 준비를 마친 후 실제 데이터만 UDP를 이용하는 경우가 대부분이다.

---

# ARP

## ARP 동작

## GARP

## RARP

---

# 서브넷과 게이트웨이

## 서브넷과 게이트웨이의 용도

## 2계층 통신 vs 3계층 통신