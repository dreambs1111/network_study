# 4장 : L2 스위치

- [이더넷](#이더넷)
- [스위치](#스위치)
  - [스위치의 동작 방식](#스위치의-동작-방식)
- [VLAN](#VLAN)
  - [VLAN의 종류와 특징](#VLAN의-종류와-특징)
  - [VLAN 태그 모드](#VLAN-태그-모드)
- [Looping](#Looping)

## 이더넷
- 전기신호를 데이터(frame) 형태로 만든다.
- 받은 전기 신호를 데이터 형태로 변경한 후 목적지 MAC 주소가 자기 MAC 주소와 맞으면 상위 계층으로 보내고, 다르면 폐기한다.
- 이더넷, NIC(네트워크 인터페이스 컨트롤러), LAN 카드, 네트워크 어댑터 등으로도 불린다.
```
MAC Address : Medium Access Control Address, 데이터 링크 계층에서의 통신을 위한 네트워크 인터페이스에 할당된 고유 식별자
```
## 스위치
- 호스트 MAC 주소와 이더넷 포트를 매핑한 테이블을 가지고 있어 필터링 및 포워딩을 할 수 있다.
- 여러 엔드시스템이 동시에 통신할 수 있어 네트워크의 통신 효율이 향상된다.

### 스위치의 3가지 동작 방식
- 플러딩 (Flooding)
  - 스위치 최초 부팅 시점에 MAC 주소 테이블을 채우기 위해 모든 포트로 패킷을 흘려보낸다.
  - 들어온 패킷이 MAC 주소에 없을 경우에도 자신이 속한 로컬 네트워크에 들어온 MAC 주소가 있다고 가정하고 플러딩한다.
  - 이더넷-TCP/IP 네트워크의 경우 ARP 브로드캐스트를 하기 때문에 스위치가 유니캐스트를 플러딩하는 경우는 거의 없다.
- 어드레스 러닝 (Address Learning)
  - 스위치의 MAC 주소 테이블을 만들고 유지하는 과정
  - 패킷이 들어온 포트 번호와 패킷의 출발지 MAC 주소로 학습
  - 스위치 간 통신을 위한 MAC 주소는 사전에 미리 정의되어 있음
- 포워딩/필터링 (Forwarding/Filtering)
  - 스위치는 포워딩/필터링을 통해 들어온 패킷이 원하는 목적지로만 전달되도록 동작
  - 일반적으로 유니캐스트에 대해서만 포워딩/필터링 작업

## VLAN (Vertical Local Area Network)
- 스위치 장비에서 사용하는 네트워크 가상화 기술
- LAN을 물리적 배치와 관계없이 논리적으로 분할, 구성
- VLAN간의 통신은 L3 장비를 거침

### VLAN의 종류와 특징
- 포트 기반 VLAN
  - 스위치의 특정 포트에 가상 네트워크를 할당하는 방식
  - 기기에 상관없이 스위치 포트에 종속적
- MAC 기반 VLAN
  - 기기의 MAC 주소를 기반으로 가상 네트워클르 할당
  - 사용자들의 자리이동이 많아지면서 개발
  - 기기에 종속적

### VLAN 태그 모드
- 여러 개의 VLAN이 존재하는 상황에서 스위치 간의 통신을 위해서는 VLAN 개수 만큼 포트를 연결해줘야 한다.
- 스위치에는 태그(Tagged) 포트를 두어 하나의 포트로 이러한 현상을 해결한다.
- 일반 포트로 데이터를 보낼때는 기존과 동일하게 보내고, 태그 포트로 보낼 때는 VLAN ID를 끼워넣어 수신측에서는 이 VLAN ID를 가지고 VLAN을 식별할 수 있게된다.
- 따라서, VLAN이 존재하는 상태에서 MAC 테이블은 VLAN 필드가 추가된다.
- 일반적인 포트를 언태그(Untagged) 또는 액세스(Access) 포트라고 한다.

## Looping
- 네트워크에 사이클에 생겨 무한 순환이 발생하는 현상
- 브로드캐스트 스톰, MAC 테이블의 주소 중복 문제

## STP (Spanning Tree Protocol)
- LAN에서 루프를 방지하기 위한 2계층 프로토콜
- 스위치들은 전체 BPDU(Bridge Protocol Data Unit) 프로토콜을 사용하여 전체 네트워크 토폴리지를 공유